"0","calcThreshold <- function(x,"
"0","                          nmads = 3,"
"0","                          type = c(""both"", ""lower"", ""upper""),"
"0","                          na.rm = FALSE){"
"0","    med_val <- stats::median(x, na.rm = na.rm)"
"0","    mad_val <- stats::mad(x, center = med_val, na.rm = na.rm)"
"0","    upper_limit <- med_val + nmads * mad_val"
"0","    lower_limit <- med_val - nmads * mad_val"
"0","    "
"0","    if (type == ""lower""){"
"0","      return(lower_limit)"
"0","    } else if (type == ""upper"") {"
"0","      return(upper_limit)"
"0","    } else("
"0","      return(list(lower_limit, upper_limit))"
"0","    )"
"0","}"
